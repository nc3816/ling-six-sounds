<!DOCTYPE html>
<html lang="en">
<head>
    <!-- 元数据和样式 -->
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ling Six Sounds Check Online Test | Improve Your Hearing Skills</title>
    <meta name="description" content="Participate in the Ling Six Sounds Check online test to assess and improve your hearing abilities with the six essential speech frequencies.">
    <!-- 引入谷歌字体 -->
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap" rel="stylesheet">
    <!-- 引入 Font Awesome 图标库 -->
    <link rel="stylesheet"
          href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css"
          integrity="sha384-DyZ88mC6Up2uqS0DQ4n7R1fv/S5Z1pKVJm6Mqv8R1WFlY5VZBr7LTTDyDAc7z5I3"
          crossorigin="anonymous">
    <link rel="icon" href="logo.png" type="image/x-icon">

    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-HXTM2BGGGB"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());

        gtag('config', 'G-HXTM2BGGGB');
    </script>
     <!-- End Google tag -->
     <!-- Google Ads -->
     <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-8658254792228498"
     crossorigin="anonymous"></script>
     <!-- End Google Ads -->
    <style>
        /* 全局样式 */
        body {
            display: flex;
            flex-direction: column;
            min-height: 100vh;
            margin: 0;
        }
        .content {
            flex: 1;
        }
        .footer { 
            width: 100%;
            padding: 10px;
            text-align: center;
            font-size: 0.9em; 
            color: #aaa; 
        }
        nav {
            display: flex;
            align-items: center;
            padding: 10px;
            background-color: #f1f1f1; /* 可根据需要调整 */
        }
        .nav-container {
            display: flex;
            align-items: center;
            width: 100%;
        }
        .nav-menu {
            list-style: none;
            display: flex;
            margin: 0;
            padding: 0;
            margin-left: auto;
        }
        .nav-item {
            margin: 0 10px;
            cursor: pointer;
        }
        .nav-item.active {
            font-weight: bold;
        }
        body {
            font-family: 'Roboto', sans-serif;
            text-align: center;
            background-color: #121212; /* 深色背景 */
            color: #e0e0e0; /* 浅色文字 */
            margin: 0;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: flex-start;
            padding-top: 70px; /* 调整以适应固定导航栏 */
            min-height: 100vh;
        }
        /* 导航菜单样式 */
        nav {
            background-color: #1f1f1f; /* 导航栏深色背景 */
            width: 100%;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.5);
            position: fixed;
            top: 0;
            left: 0;
            z-index: 1000;
        }
        .nav-menu {
            list-style: none;
            display: flex;
            justify-content: flex-end; /* 右侧对齐导航菜单 */
            margin: 0;
            padding: 0 20px;
        }
        .nav-item {
            padding: 15px 20px;
            cursor: pointer;
            color: #e0e0e0;
            font-weight: bold;
            transition: background 0.3s, color 0.3s;
            text-transform: uppercase;
            position: relative;
        }
        .nav-item::after {
            content: '';
            position: absolute;
            bottom: 10px;
            left: 50%;
            transform: translateX(-50%);
            width: 0%;
            height: 2px;
            background-color: #6200ea; /* 紫色下划线 */
            transition: width 0.3s;
        }
        .nav-item:hover::after {
            width: 100%;
        }
        .nav-item:hover {
            color: #bb86fc; /* 浅紫色 */
        }
        .nav-item.active {
            color: #bb86fc;
        }
        h1 {
            font-size: 2.5em;
            margin-top: 20px;
            margin-bottom: 20px;
            color: #bb86fc; /* 浅紫色标题 */
        }
        h2 {
            font-size: 1.5em;
            color: #bb86fc; /* 浅紫色标题 */
        }
        p {
            font-size: 1.2em;
            margin-bottom: 30px;
            color: #e0e0e0;
            line-height: 1.6;
        }
        .content {
            flex: 1;
        }
        .tab-content {
            width: 100%;
            max-width: 800px;
            padding: 20px;
            box-sizing: border-box;
        }
        .hidden {
            display: none;
        }
        /* 首页按钮样式 */
        .home-buttons {
            margin-top: 30px;
            display: flex;
            justify-content: center;
            gap: 30px;
            flex-wrap: wrap;
        }
        .home-button {
            margin: 10px;
            padding: 15px 50px;
            font-size: 1.2em;
            font-weight: bold;
            cursor: pointer;
            border: 2px solid #6200ea;
            border-radius: 30px;
            background: transparent;
            color: #e0e0e0;
            transition: all 0.3s ease;
        }
        .home-button:hover {
            background: #6200ea;
            border-color: #bb86fc;
            color: #ffffff;
            box-shadow: 0 4px 6px rgba(98, 0, 234, 0.5);
            transform: translateY(-2px);
        }
        /* 按钮和选择器的通用样式 */
        .sound-button, select {
            background-color: #1f1f1f;
            color: #e0e0e0;
            border: 2px solid #6200ea;
            border-radius: 30px;
            padding: 15px 30px;
            font-size: 1em;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
            margin: 10px;
        }
        .sound-button:hover, select:hover {
            background-color: #6200ea;
            border-color: #bb86fc;
            color: #ffffff;
            box-shadow: 0 4px 6px rgba(98, 0, 234, 0.5);
            transform: translateY(-2px);
        }
        .sound-button:active {
            transform: translateY(1px);
        }
        /* 小型按钮样式 */
        .small-button {
            padding: 5px 10px;
            font-size: 0.9em;
            margin-left: 5px;
            display: inline-block;
            border: 2px solid #6200ea;
            border-radius: 20px;
            background-color: #1f1f1f;
            color: #e0e0e0;
            cursor: pointer;
            transition: all 0.3s ease;
        }
        .small-button:hover {
            background-color: #6200ea;
            border-color: #bb86fc;
            color: #ffffff;
        }
        /* 进度条样式 */
        #progressBar, #sameOrDifferentProgressBar {
            width: 80%;
            height: 20px;
            background: #3c3c3c;
            border-radius: 10px;
            overflow: hidden;
            margin: 20px auto;
        }
        #progress, #sameOrDifferentProgress {
            height: 100%;
            background: linear-gradient(90deg, #6200ea, #bb86fc);
            width: 0;
        }
        /* 测试选项样式 */
        .test-options {
            display: flex;
            flex-wrap: wrap;
            gap: 15px;
            justify-content: center;
            align-items: center;
            margin-bottom: 20px;
        }
        /* 描述容器样式 */
        .description-container {
            max-width: 800px;
            margin: 0 auto;
            text-align: justify;
        }
        /* 手动模式按钮容器样式 */
        .sound-button-container {
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            gap: 20px;
        }
        .sound-button-container .sound-button {
            flex: 0 0 calc(45% - 20px);
        }
        /* 响应式设计 */
        @media (max-width: 600px) {
            .nav-item {
                padding: 10px 15px;
            }
            .home-buttons {
                flex-direction: column;
            }
            .home-button {
                width: 80%;
                margin: 10px auto;
            }
            .sound-button-container .sound-button {
                flex: 0 0 calc(100% - 20px);
            }
        }
        .contact-form {
            max-width: 600px;
            margin: 0 auto;
            padding: 20px;
            background: #1f1f1f;
            border-radius: 10px;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.3);
            text-align: center;
        }
        .contact-form input, .contact-form textarea {
            width: calc(100% - 20px);
            padding: 10px;
            margin: 10px 0;
            border: none;
            border-radius: 5px;
            background: #333;
            color: #e0e0e0;
            font-size: 1em;
            box-sizing: border-box;
        }
        .contact-form textarea {
            resize: none;
            height: 100px;
        }
        .contact-form button {
            background: #6200ea;
            color: #fff;
            border: none;
            padding: 10px 20px;
            font-size: 1.2em;
            border-radius: 5px;
            cursor: pointer;
            transition: background 0.3s ease;
            width: 100%;
        }
        .contact-form button:hover {
            margin-top: auto;
            background: #bb86fc;
            padding: 10px; /* 可根据需要调整 */
            text-align: center;
            width: 100%;
        }
        .footer { 
            width: 100%;
            padding: 10px;
            text-align: center;
            font-size: 0.9em; 
            color: #aaa; 
        }
    </style>
</head>
<body>
    <!-- 导航菜单 -->
    <nav>
        <img src="logo.png" alt="Ling Six Sounds Logo" style="height: 50px;">
        <ul class="nav-menu">
            <li class="nav-item active" onclick="showTab('home')">Home</li>
            <li class="nav-item" onclick="showTab('practice')">Practice</li>
            <li class="nav-item" onclick="showTab('test')">Test</li>
            <li class="nav-item" onclick="showTab('about')">About</li>
            <li class="nav-item" onclick="showTab('contact')">Contact</li>
        </ul>
    </nav>

    <h1>Ling Six Sounds Check Online Test</h1>

    <!-- 首页 -->
    <div id="home" class="tab-content">
        <div id="description" class="description-container">
            <h2> What is the Ling Six Sounds Test? </h2>
            <p>
                The Ling Six Sounds Check is a simple yet effective tool used to assess an individual's ability to hear and distinguish a range of speech frequencies essential for understanding spoken language. It involves six distinct sounds: "ah," "ee," "oo," "sh," "s," and "mm," which represent low to high frequencies of speech.
            </p>
            <p>This test is widely used in audiology to assess hearing loss and the effectiveness of hearing aids or cochlear implants.</p>
            <p>
                Welcome to the Ling Six Sounds Check Online version! This interactive platform allows you to practice and test your hearing abilities conveniently from anywhere. We hope you enjoy using this tool and find it helpful in improving your auditory skills.
            </p>
            <p style="text-align: center; margin-top: 40px; font-size: 1.5em; color: #bb86fc;">
                Would you like to try?
            </p>
            <div class="home-buttons">
                <button class="home-button" onclick="showTab('practice')">Go to Practice</button>
                <button class="home-button" onclick="showTab('test')">Go to Test</button>
            </div>
        </div>
    </div>

    <!-- Practice 页面 -->
    <div id="practice" class="tab-content hidden">
        <p>Please select a practice mode:</p>
        <select id="practiceMode" onchange="changePracticeMode(this.value)">
            <option value="manual" selected>Manual Mode</option>
            <option value="loop">Loop Mode</option>
        </select>

        <div id="manualMode">
            <p>Click on each button to listen to a Ling Six Sound.</p>
            <div class="sound-button-container">
                <button class="sound-button" onclick="playSound('ah')">Play "ah" <i class="fas fa-volume-up"></i></button>
                <button class="sound-button" onclick="playSound('ee')">Play "ee" <i class="fas fa-volume-up"></i></button>
                <button class="sound-button" onclick="playSound('oo')">Play "oo" <i class="fas fa-volume-up"></i></button>
                <button class="sound-button" onclick="playSound('sh')">Play "sh" <i class="fas fa-volume-up"></i></button>
                <button class="sound-button" onclick="playSound('s')">Play "s" <i class="fas fa-volume-up"></i></button>
                <button class="sound-button" onclick="playSound('mm')">Play "mm" <i class="fas fa-volume-up"></i></button>
            </div>
        </div>

        <div id="loopMode" class="hidden">
            <p>The system will randomly play the six sounds. Please listen carefully.</p>
            <button class="sound-button" onclick="startLoop()">Start Loop Mode <i class="fas fa-play"></i></button>
            <button class="sound-button" onclick="stopLoop()">Stop Loop Mode <i class="fas fa-stop"></i></button>
            <div id="currentSound" style="margin-top: 20px; font-size: 1.5em; color: #bb86fc;"></div>
        </div>
    </div>

    <!-- Test 页面 -->
    <div id="test" class="tab-content">
        <!-- 测试类型选择 -->
        <div id="testTypeSelection">
            <p>Select the type of test:</p>
            <select id="testType">
                <option value="" disabled selected>Select test type</option>
                <option value="multipleChoice">Multiple Choice</option>
                <option value="sameOrDifferent">Same or Different</option>
            </select>
        </div>

        <!-- Multiple Choice 测试 -->
        <div id="multipleChoiceTest" class="hidden">
            <!-- 显示当前测试类型 -->
            <div id="currentTestType" style="font-size: 1.2em; color: #bb86fc; margin-top: 20px;"></div>
            <div id="testSettings">
                <div class="test-options">
                    <div>
                        <p>Select the number of options for the test:</p>
                        <select id="optionCount">
                            <option value="2" selected>2 Options</option>
                            <option value="3">3 Options</option>
                            <option value="4">4 Options</option>
                            <option value="5">5 Options</option>
                            <option value="6">6 Options</option>
                        </select>
                    </div>
                    <div>
                        <p>Select the number of questions:</p>
                        <select id="questionCount">
                            <option value="10">10 Questions</option>
                            <option value="30">30 Questions</option>
                            <option value="50">50 Questions</option>
                        </select>
                    </div>
                    <div>
                        <p>Select the number of replays allowed per question:</p>
                        <select id="replayCount">
                            <option value="1">1 Time</option>
                            <option value="2">2 Times</option>
                            <option value="unlimited" selected>Unlimited</option>
                        </select>
                    </div>
                </div>
            </div>
            <div style="margin-top: 20px;">
                <button class="sound-button" id="startTest" onclick="startTest()">Start Test <i class="fas fa-play"></i></button>
                <button class="sound-button hidden" id="exitTest" onclick="exitTest()" style="position: fixed; bottom: 20px; right: 20px;">Exit Test <i class="fas fa-stop"></i></button>
            </div>
            <div id="progressBar" class="hidden">
                <div id="progress"></div>
            </div>
            <div id="testButtons" style="margin-top: 20px;"></div>
            <div id="resultMessage" style="margin-top: 20px; font-size: 1.5em;"></div>
            <button id="replayButton" class="sound-button hidden" onclick="replaySound()">Replay Sound <i class="fas fa-redo"></i></button>
            <!-- 添加用于显示重播次数的消息 -->
            <div id="replayMessage" style="margin-top: 10px; font-size: 1em; color: #03dac5;"></div>
            <button id="nextButton" class="sound-button hidden" onclick="nextQuestion()">Next</button>
            <div id="finalResult" class="hidden" style="margin-top: 20px; font-size: 1.5em;"></div>
        </div>

        <!-- Same or Different 测试 -->
        <div id="sameOrDifferentTest" class="hidden">
            <!-- 显示当前测试类型 -->
            <div id="currentTestTypeSameOrDifferent" style="font-size: 1.2em; color: #bb86fc; margin-top: 20px;"></div>
            <div id="sameOrDifferentSettings">
                <div class="test-options">
                    <div>
                        <p>Select the number of questions:</p>
                        <select id="sameOrDifferentQuestionCount">
                            <option value="10">10 Questions</option>
                            <option value="30">30 Questions</option>
                            <option value="50">50 Questions</option>
                        </select>
                    </div>
                    <div>
                        <p>Select the number of replays allowed per question:</p>
                        <select id="sameOrDifferentReplayCount">
                            <option value="1">1 Time</option>
                            <option value="2">2 Times</option>
                            <option value="unlimited" selected>Unlimited</option>
                        </select>
                    </div>
                </div>
            </div>
            <div style="margin-top: 20px;">
                <button class="sound-button" id="startSameOrDifferentTest" onclick="startSameOrDifferentTest()">Start Test <i class="fas fa-play"></i></button>
                <button class="sound-button hidden" id="exitSameOrDifferentTest" onclick="exitTest()" style="position: fixed; bottom: 20px; right: 20px;">Exit Test <i class="fas fa-stop"></i></button>
            </div>
            <div id="sameOrDifferentProgressBar" class="hidden">
                <div id="sameOrDifferentProgress"></div>
            </div>
            <div id="pairingMessage" class="hidden">Please listen carefully, now playing...</div>
            <button id="sameOrDifferentReplayButton" class="sound-button hidden" onclick="replaySameOrDifferent()">Replay Sound <i class="fas fa-redo"></i></button>
            <div id="sameOrDifferentReplayMessage" style="margin-top: 10px; font-size: 1em; color: #03dac5;"></div>
            <div id="sameOrDifferentButtons" style="margin-top: 20px;"></div>
            <div id="sameOrDifferentResult" style="margin-top: 20px; font-size: 1.5em;"></div>
            <button id="sameOrDifferentNextButton" class="sound-button hidden" onclick="nextSameOrDifferent()">Next</button>
            <div id="sameOrDifferentFinalResult" class="hidden" style="margin-top: 20px; font-size: 1.5em;"></div>
        </div>
    </div>

     <!-- ABOUT US 页面 -->
    <div id="about" class="tab-content hidden">
        <div id="description" class="description-container">
            <p>
                Welcome to Ling Six Sounds Check Online Test! We are committed to helping users worldwide enhance their auditory skills by providing a scientifically validated hearing test tool.
            </p>
            <p>This project was developed by a cochlear implant user who underwent auditory rehabilitation in the United States and holds a master’s degree in Computer Science. As a developer with hearing impairment, she understands the importance of auditory training and created this online tool to make it easier for more people to assess and improve their ability to distinguish speech sounds.</p>
            <p>
                The Ling Six Sounds Test is an internationally recognized fundamental hearing assessment method, used to evaluate the auditory abilities of individuals with hearing loss and assist them in making better use of hearing aids or cochlear implants. This platform integrates modern web technology to provide a more convenient and intuitive testing experience, making it suitable for anyone who needs hearing evaluation or training.
            </p>
            <p>We hope this tool proves helpful to you, and we welcome your feedback. If you are interested in this project, feel free to contact us!</p>
            <p style="text-align: center; margin-top: 40px; font-size: 1.5em; color: #bb86fc;">
                Would you like to try?
            </p>
            <div class="home-buttons">
                <button class="home-button" onclick="showTab('practice')">Go to Practice</button>
                <button class="home-button" onclick="showTab('test')">Go to Test</button>
            </div>
        </div>
    </div>

    <div id="contact" class="tab-content hidden">
        <div id="description" class="description-container"></div>
            <h2>Contact Us</h2>
            <p>If you have any questions or feedback, feel free to reach out to us via the form below or email us at <a href="mailto:lingsixsoundsonlinetest@gmail.com" style="color: #bb86fc;">lingsixsoundsonlinetest@gmail.com</a>.</p>
                <div class="contact-form">
                    <form action="mailto:lingsixsoundsonlinetest@gmail.com" method="post" enctype="text/plain">
                        <input type="text" name="name" placeholder="Your Name" required>
                        <input type="email" name="email" placeholder="Your Email" required>
                        <textarea name="message" rows="4" placeholder="Your Message" required></textarea>
                        <button type="submit">Send Message</button>
                    </form>
                </div>
        </div>
    </div>

    <div id="playingMessage" class="hidden">Please listen carefully, now playing...</div>
    <footer class="footer">
        <p>&copy; 2025 Ling Six Sounds Check Online Test. All rights reserved. | <a href="privacy.html" style="color: #bb86fc;">Privacy Policy</a></p>
    </footer>

    <script>
        // 声音列表
        const sounds = ['ah', 'ee', 'oo', 'sh', 's', 'mm'];
        let correctSound = '';
        let currentQuestion = 0;
        let totalQuestions = 0;
        let correctAnswers = 0;
        let incorrectCounts = { 'ah': 0, 'ee': 0, 'oo': 0, 'sh': 0, 's': 0, 'mm': 0 };
        let isLooping = false;
        let maxReplays = 'unlimited';
        let replayUsed = 0;
        // 添加一个状态变量，指示是否可以显示重播按钮
        let canReplay = false;

        // Same or Different 相关变量
        let sameOrDifferentQuestions = 0;
        let sameOrDifferentCurrentQuestion = 0;
        let sameOrDifferentMaxReplays = 'unlimited';
        let sameOrDifferentReplayUsed = 0;
        let sameOrDifferentCorrectAnswers = 0;
        let currentSoundPair = [];
        // 添加一个状态变量，指示是否可以显示重播按钮
        let canReplaySameOrDifferent = false;

        function playSound(sound, callback) {
            const playingMessage = document.getElementById('playingMessage');
            playingMessage.classList.remove('hidden');
            const audio = new Audio(`sounds/${sound}.wav`);
            audio.play();
            audio.onended = () => {
                playingMessage.classList.add('hidden');
                if (callback) callback();
            };
        }

        function showTab(tabId) {
            document.querySelectorAll('.nav-item').forEach(item => item.classList.remove('active'));
            document.querySelectorAll('.tab-content').forEach(content => content.classList.add('hidden'));
            document.getElementById(tabId).classList.remove('hidden');
            document.querySelector(`.nav-item[onclick="showTab('${tabId}')"]`).classList.add('active');

            // 如果是 Home 页面，显示描述
            if (tabId === 'home') {
                document.getElementById('description').style.display = 'block';
            } else {
                document.getElementById('description').style.display = 'none';
            }

            // 当点击 Test 菜单时，重置测试页面
            if (tabId === 'test') {
                resetTestPage();
            }
        }

        function resetTestPage() {
            // 显示测试类型选择
            document.getElementById('testTypeSelection').classList.remove('hidden');

            // 隐藏测试内容
            document.getElementById('multipleChoiceTest').classList.add('hidden');
            document.getElementById('sameOrDifferentTest').classList.add('hidden');

            // 重置 Multiple Choice 测试相关元素
            document.getElementById('progressBar').classList.add('hidden');
            document.getElementById('finalResult').classList.add('hidden');
            document.getElementById('startTest').classList.remove('hidden');
            document.getElementById('exitTest').classList.add('hidden');
            document.getElementById('testSettings').classList.remove('hidden');
            document.getElementById('resultMessage').innerHTML = '';
            document.getElementById('nextButton').classList.add('hidden');
            document.getElementById('replayButton').classList.add('hidden');
            document.getElementById('replayMessage').textContent = '';
            document.getElementById('testButtons').innerHTML = '';
            document.getElementById('currentTestType').textContent = '';
            currentQuestion = 0;
            correctAnswers = 0;
            canReplay = false;

            // 重置 Same or Different 测试相关元素
            document.getElementById('sameOrDifferentProgressBar').classList.add('hidden');
            document.getElementById('sameOrDifferentFinalResult').classList.add('hidden');
            document.getElementById('startSameOrDifferentTest').classList.remove('hidden');
            document.getElementById('exitSameOrDifferentTest').classList.add('hidden');
            document.getElementById('sameOrDifferentSettings').classList.remove('hidden');
            document.getElementById('sameOrDifferentResult').textContent = '';
            document.getElementById('sameOrDifferentNextButton').classList.add('hidden');
            document.getElementById('sameOrDifferentReplayButton').classList.add('hidden');
            document.getElementById('sameOrDifferentReplayMessage').textContent = '';
            document.getElementById('sameOrDifferentButtons').innerHTML = '';
            document.getElementById('currentTestTypeSameOrDifferent').textContent = '';
            sameOrDifferentCurrentQuestion = 0;
            sameOrDifferentCorrectAnswers = 0;
            canReplaySameOrDifferent = false;

            // 重置测试类型选择
            document.getElementById('testType').value = '';
        }

        function changePracticeMode(value) {
            const manualMode = document.getElementById('manualMode');
            const loopMode = document.getElementById('loopMode');
            if (value === 'manual') {
                manualMode.classList.remove('hidden');
                loopMode.classList.add('hidden');
            } else if (value === 'loop') {
                manualMode.classList.add('hidden');
                loopMode.classList.remove('hidden');
            }
        }

        function startLoop() {
            if (isLooping) return;
            isLooping = true;
            loopSounds();
        }

        function stopLoop() {
            isLooping = false;
            document.getElementById('currentSound').textContent = '';
        }

        function loopSounds() {
            if (!isLooping) return;
            const randomSound = sounds[Math.floor(Math.random() * sounds.length)];
            document.getElementById('currentSound').textContent = `Now playing: "${randomSound}"`;
            playSound(randomSound, () => {
                if (isLooping) setTimeout(loopSounds, 2000);
            });
        }

        // 当选择测试类型时，显示对应的测试设置
        document.getElementById('testType').addEventListener('change', function () {
            const testType = this.value;
            document.getElementById('multipleChoiceTest').classList.add('hidden');
            document.getElementById('sameOrDifferentTest').classList.add('hidden');

            if (testType === 'multipleChoice') {
                document.getElementById('multipleChoiceTest').classList.remove('hidden');
            } else if (testType === 'sameOrDifferent') {
                document.getElementById('sameOrDifferentTest').classList.remove('hidden');
            }
        });

        // Multiple Choice 测试相关函数
        function startTest() {
            const optionCount = parseInt(document.getElementById('optionCount').value);
            totalQuestions = parseInt(document.getElementById('questionCount').value);
            maxReplays = document.getElementById('replayCount').value;
            currentQuestion = 0;
            correctAnswers = 0;
            incorrectCounts = { 'ah': 0, 'ee': 0, 'oo': 0, 'sh': 0, 's': 0, 'mm': 0 };
            document.getElementById('progressBar').classList.remove('hidden');
            document.getElementById('finalResult').classList.add('hidden');
            document.getElementById('startTest').classList.add('hidden');
            document.getElementById('exitTest').classList.remove('hidden');
            // 隐藏测试类型选择和测试设置
            document.getElementById('testTypeSelection').classList.add('hidden');
            document.getElementById('testSettings').classList.add('hidden');
            // 显示当前测试类型
            document.getElementById('currentTestType').textContent = 'You are currently taking the Multiple Choice test.';
            nextQuestion();
        }

        function exitTest() {
            resetTestPage();
        }

        function nextQuestion() {
            if (currentQuestion >= totalQuestions) {
                showFinalResult();
                return;
            }
            currentQuestion++;
            replayUsed = 0; // 重置已使用的重播次数
            document.getElementById('replayMessage').textContent = ''; // 清除重播消息
            document.getElementById('resultMessage').innerHTML = '';
            document.getElementById('nextButton').classList.add('hidden');
            document.getElementById('replayButton').classList.add('hidden');
            document.getElementById('replayButton').disabled = false; // 重新启用重播按钮
            canReplay = true; // 允许重播
            updateProgress();
            generateQuestion();
        }

        function generateQuestion() {
            const optionCount = parseInt(document.getElementById('optionCount').value);
            const testButtons = document.getElementById('testButtons');
            testButtons.innerHTML = '';
            const shuffledSounds = sounds.sort(() => 0.5 - Math.random()).slice(0, optionCount);
            correctSound = shuffledSounds[Math.floor(Math.random() * shuffledSounds.length)];

            shuffledSounds.forEach(sound => {
                const button = document.createElement('button');
                button.className = 'sound-button';
                button.textContent = sound;
                button.onclick = () => checkAnswer(sound);
                testButtons.appendChild(button);
            });

            playSound(correctSound, () => {
                if (canReplay) {
                    document.getElementById('replayButton').classList.remove('hidden');
                }
            });
        }

        function replaySound() {
            const replayMessage = document.getElementById('replayMessage');
            if (maxReplays === 'unlimited') {
                playSound(correctSound);
            } else {
                const allowedReplays = parseInt(maxReplays);
                if (replayUsed < allowedReplays) {
                    playSound(correctSound);
                    replayUsed++;
                    const attemptsLeft = allowedReplays - replayUsed;
                    if (attemptsLeft > 0) {
                        replayMessage.style.color = '#03dac5'; // 绿色
                        replayMessage.textContent = `You have ${attemptsLeft} replay attempt${attemptsLeft > 1 ? 's' : ''} remaining.`;
                    } else {
                        replayMessage.style.color = '#cf6679'; // 红色
                        replayMessage.textContent = 'You have no replay attempts remaining.';
                    }
                } else {
                    replayMessage.style.color = '#cf6679'; // 红色
                    replayMessage.textContent = 'Your replay attempts have been used up.';
                }
            }
        }

        function checkAnswer(selectedSound) {
            const resultMessage = document.getElementById('resultMessage');
            // 无论正确与否，隐藏重播按钮
            document.getElementById('replayButton').classList.add('hidden');
            canReplay = false; // 禁止重播
            document.getElementById('replayMessage').textContent = ''; // 清除重播消息
            if (selectedSound === correctSound) {
                resultMessage.textContent = 'Correct!';
                resultMessage.style.color = '#03dac5'; /* 绿色 */
                correctAnswers++;
            } else {
                resultMessage.innerHTML = `You chose "${selectedSound}" <button class="small-button" onclick="playSound('${selectedSound}')">Play <i class="fas fa-play"></i></button>, the correct answer was "${correctSound}" <button class="small-button" onclick="playSound('${correctSound}')">Play <i class="fas fa-play"></i></button>.`;
                resultMessage.style.color = '#cf6679'; /* 红色 */
                incorrectCounts[correctSound]++;
                // 在提示消息下方添加一句话
                resultMessage.innerHTML += '<br><span style="font-size: 0.9em;">You can click the play buttons above to compare.</span>';
            }
            // 禁用所有按钮
            document.querySelectorAll('#testButtons .sound-button').forEach(button => button.disabled = true);
            document.getElementById('nextButton').classList.remove('hidden');
        }

        function updateProgress() {
            const progress = document.getElementById('progress');
            progress.style.width = `${(currentQuestion / totalQuestions) * 100}%`;
        }

        function showFinalResult() {
            const finalResult = document.getElementById('finalResult');
            finalResult.classList.remove('hidden');
            const mostIncorrect = Object.keys(incorrectCounts).reduce((a, b) => incorrectCounts[a] > incorrectCounts[b] ? a : b);
            finalResult.innerHTML = `
                Test completed!<br>
                Correct answers: ${correctAnswers}/${totalQuestions}<br>
                Most incorrect sound: "${mostIncorrect}" with ${incorrectCounts[mostIncorrect]} errors.
            `;
            document.getElementById('exitTest').classList.add('hidden');
        }

        // Same or Different 测试相关函数
        function startSameOrDifferentTest() {
            sameOrDifferentQuestions = parseInt(document.getElementById('sameOrDifferentQuestionCount').value);
            sameOrDifferentMaxReplays = document.getElementById('sameOrDifferentReplayCount').value;
            sameOrDifferentCurrentQuestion = 0;
            sameOrDifferentCorrectAnswers = 0;
            document.getElementById('sameOrDifferentProgressBar').classList.remove('hidden');
            document.getElementById('sameOrDifferentFinalResult').classList.add('hidden');
            document.getElementById('startSameOrDifferentTest').classList.add('hidden');
            document.getElementById('exitSameOrDifferentTest').classList.remove('hidden');
            // 隐藏测试类型选择和测试设置
            document.getElementById('testTypeSelection').classList.add('hidden');
            document.getElementById('sameOrDifferentSettings').classList.add('hidden');
            // 显示当前测试类型
            document.getElementById('currentTestTypeSameOrDifferent').textContent = 'You are currently taking the Same or Different test.';
            nextSameOrDifferent();
        }

        function nextSameOrDifferent() {
            if (sameOrDifferentCurrentQuestion >= sameOrDifferentQuestions) {
                showSameOrDifferentFinalResult();
                return;
            }
            sameOrDifferentCurrentQuestion++;
            sameOrDifferentReplayUsed = 0; // 重置已使用的重播次数
            document.getElementById('sameOrDifferentReplayMessage').textContent = ''; // 清除重播消息
            document.getElementById('sameOrDifferentResult').textContent = '';
            document.getElementById('sameOrDifferentNextButton').classList.add('hidden');
            document.getElementById('sameOrDifferentReplayButton').classList.add('hidden');
            document.getElementById('sameOrDifferentReplayButton').disabled = false; // 重新启用重播按钮
            canReplaySameOrDifferent = true; // 允许重播
            updateSameOrDifferentProgress();
            generateSameOrDifferentQuestion();
        }

        function generateSameOrDifferentQuestion() {
            currentSoundPair = [sounds[Math.floor(Math.random() * sounds.length)], sounds[Math.floor(Math.random() * sounds.length)]];
            const pairingMessage = document.getElementById('pairingMessage');
            pairingMessage.classList.remove('hidden');
            pairingMessage.textContent = 'Playing first sound...';
            playSound(currentSoundPair[0], () => {
                pairingMessage.textContent = 'Playing second sound...';
                playSound(currentSoundPair[1], () => {
                    pairingMessage.classList.add('hidden');
                    const buttonsContainer = document.getElementById('sameOrDifferentButtons');
                    buttonsContainer.innerHTML = '';
                    const sameButton = document.createElement('button');
                    sameButton.className = 'sound-button';
                    sameButton.textContent = 'Same';
                    sameButton.onclick = () => checkSameOrDifferent(true);
                    const differentButton = document.createElement('button');
                    differentButton.className = 'sound-button';
                    differentButton.textContent = 'Different';
                    differentButton.onclick = () => checkSameOrDifferent(false);
                    buttonsContainer.appendChild(sameButton);
                    buttonsContainer.appendChild(differentButton);
                    if (canReplaySameOrDifferent) {
                        document.getElementById('sameOrDifferentReplayButton').classList.remove('hidden');
                    }
                });
            });
        }

        function replaySameOrDifferent() {
            const replayMessage = document.getElementById('sameOrDifferentReplayMessage');
            if (sameOrDifferentMaxReplays === 'unlimited') {
                playSoundPair();
            } else {
                const allowedReplays = parseInt(sameOrDifferentMaxReplays);
                if (sameOrDifferentReplayUsed < allowedReplays) {
                    playSoundPair();
                    sameOrDifferentReplayUsed++;
                    const attemptsLeft = allowedReplays - sameOrDifferentReplayUsed;
                    if (attemptsLeft > 0) {
                        replayMessage.style.color = '#03dac5'; // 绿色
                        replayMessage.textContent = `You have ${attemptsLeft} replay attempt${attemptsLeft > 1 ? 's' : ''} remaining.`;
                    } else {
                        replayMessage.style.color = '#cf6679'; // 红色
                        replayMessage.textContent = 'You have no replay attempts remaining.';
                    }
                } else {
                    replayMessage.style.color = '#cf6679'; // 红色
                    replayMessage.textContent = 'Your replay attempts have been used up.';
                }
            }
        }

        function playSoundPair() {
            const pairingMessage = document.getElementById('pairingMessage');
            pairingMessage.classList.remove('hidden');
            pairingMessage.textContent = 'Replaying first sound...';
            playSound(currentSoundPair[0], () => {
                pairingMessage.textContent = 'Replaying second sound...';
                playSound(currentSoundPair[1], () => {
                    pairingMessage.classList.add('hidden');
                });
            });
        }

        function checkSameOrDifferent(isSame) {
            const resultMessage = document.getElementById('sameOrDifferentResult');
            // 无论正确与否，隐藏重播按钮
            document.getElementById('sameOrDifferentReplayButton').classList.add('hidden');
            canReplaySameOrDifferent = false; // 禁止重播
            document.getElementById('sameOrDifferentReplayMessage').textContent = ''; // 清除重播消息
            if ((currentSoundPair[0] === currentSoundPair[1] && isSame) || (currentSoundPair[0] !== currentSoundPair[1] && !isSame)) {
                resultMessage.textContent = 'Correct!';
                resultMessage.style.color = '#03dac5'; /* 绿色 */
                sameOrDifferentCorrectAnswers++;
            } else {
                resultMessage.textContent = 'Incorrect!';
                resultMessage.style.color = '#cf6679'; /* 红色 */
            }
            document.getElementById('sameOrDifferentNextButton').classList.remove('hidden');
            document.getElementById('sameOrDifferentButtons').innerHTML = '';
        }

        function updateSameOrDifferentProgress() {
            const progress = document.getElementById('sameOrDifferentProgress');
            progress.style.width = `${(sameOrDifferentCurrentQuestion / sameOrDifferentQuestions) * 100}%`;
        }

        function showSameOrDifferentFinalResult() {
            const finalResult = document.getElementById('sameOrDifferentFinalResult');
            finalResult.classList.remove('hidden');
            finalResult.innerHTML = `
                Test completed!<br>
                Correct answers: ${sameOrDifferentCorrectAnswers}/${sameOrDifferentQuestions}
            `;
            document.getElementById('exitSameOrDifferentTest').classList.add('hidden');
        }

        // 页面加载时显示首页
        document.addEventListener('DOMContentLoaded', () => {
            showTab('home');
        });
    </script>
</body>
</html>
