<!DOCTYPE html>
<html lang="en">
<head>
    <!-- 元数据和样式 -->
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ling Six Sound Check</title>
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap" rel="stylesheet">
    <link rel="stylesheet"
          href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css"
          integrity="sha384-k6RqeWeci5ZR/Lv4MR0sA0FfDOM7zYl5dox6Lt4Ah96em7w5eau8m/AI6qZ4P4p6"
          crossorigin="anonymous">
    <style>
        /* 样式 */
        body {
            font-family: 'Roboto', sans-serif;
            text-align: center;
            background: linear-gradient(to right, #83a4d4, #b6fbff);
            color: #333;
            margin: 0;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: flex-start;
            padding-top: 60px; /* 调整以适应固定导航栏 */
            min-height: 100vh;
        }
        nav {
            background: #ffffff;
            width: 100%;
            box-shadow: 0 8px 15px rgba(0, 0, 0, 0.1);
            position: fixed;
            top: 0;
            left: 0;
            z-index: 1000;
        }
        .nav-menu {
            list-style: none;
            display: flex;
            justify-content: flex-start;
            margin: 0;
            padding: 0;
        }
        .nav-item {
            padding: 15px 20px;
            cursor: pointer;
            color: #0077b6;
            font-weight: bold;
            transition: background 0.3s, color 0.3s;
        }
        .nav-item:hover {
            background: #0077b6;
            color: #ffffff;
        }
        .nav-item.active {
            background: #0077b6;
            color: #ffffff;
        }
        h1 {
            font-size: 2.5em;
            margin-top: 20px;
            margin-bottom: 20px;
            color: #ffffff;
        }
        p {
            font-size: 1.2em;
            margin-bottom: 30px;
            color: #ffffff;
        }
        .tab-content {
            width: 100%;
            max-width: 800px;
            padding: 20px;
            box-sizing: border-box;
        }
        .hidden {
            display: none;
        }
        .home-buttons {
            margin-top: 20px;
        }
        .home-button {
            margin: 10px;
            padding: 15px 40px;
            font-size: 1.1em;
            font-weight: bold;
            cursor: pointer;
            border: none;
            border-radius: 50px;
            background: #ffffff;
            color: #0077b6;
            box-shadow: 0 8px 15px rgba(0, 0, 0, 0.1);
            transition: all 0.3s ease;
        }
        .home-button:hover {
            background: #0077b6;
            color: #ffffff;
            box-shadow: 0 15px 20px rgba(0, 0, 0, 0.3);
            transform: translateY(-3px);
        }
        /* 以下是 practice 和 test 部分的样式 */
        .sound-button {
            margin: 10px;
            padding: 15px 40px;
            font-size: 1.1em;
            font-weight: bold;
            cursor: pointer;
            border: none;
            border-radius: 50px;
            background: #ffffff;
            color: #0077b6;
            box-shadow: 0 8px 15px rgba(0, 0, 0, 0.1);
            transition: all 0.3s ease;
        }
        .sound-button:hover {
            background: #0077b6;
            color: #ffffff;
            box-shadow: 0 15px 20px rgba(0, 0, 0, 0.3);
            transform: translateY(-3px);
        }
        .sound-button:active {
            transform: translateY(1px);
        }
        select {
            padding: 10px;
            border-radius: 10px;
            border: 1px solid #0077b6;
            font-size: 1em;
            background-color: #ffffff;
            color: #0077b6;
            cursor: pointer;
            box-shadow: 0 8px 15px rgba(0, 0, 0, 0.1);
            transition: all 0.3s ease;
        }
        select:focus {
            outline: none;
            box-shadow: 0 15px 20px rgba(0, 0, 0, 0.3);
        }
        #playingMessage {
            font-size: 1.5em;
            color: #ffffff;
            margin-top: 20px;
        }
        #currentSound {
            margin-top: 20px;
            font-size: 2em;
            color: #ffffff;
        }
        #progressBar {
            width: 80%;
            height: 20px;
            background: #e0e0e0;
            border-radius: 10px;
            overflow: hidden;
            margin: 20px auto;
        }
        #progress {
            height: 100%;
            background: #0077b6;
            width: 0;
        }
        .test-options {
            display: flex;
            gap: 15px;
            justify-content: center;
            align-items: center;
            margin-bottom: 20px;
        }
        .description-container {
            max-width: 800px;
            margin: 0 auto;
            text-align: justify;
        }
    </style>
</head>
<body>
    <!-- 导航菜单 -->
    <nav>
        <ul class="nav-menu">
            <li class="nav-item active" onclick="showTab('home')">Home</li>
            <li class="nav-item" onclick="showTab('practice')">Practice</li>
            <li class="nav-item" onclick="showTab('test')">Test</li>
        </ul>
    </nav>

    <h1>Ling Six Sound Check</h1>

    <!-- 首页 -->
    <div id="home" class="tab-content">
        <div id="description" class="description-container">
            <p>
                The Ling Six Sounds Check is a simple yet effective tool used to assess an individual's ability to hear and distinguish a range of speech frequencies essential for understanding spoken language. It involves six distinct sounds: "ah," "ee," "oo," "sh," "s," and "mm," which represent low to high frequencies of speech.
            </p>
            <p>
                Welcome to the Ling Six Sounds Check Online version! This interactive platform allows you to practice and test your hearing abilities conveniently from anywhere. We hope you enjoy using this tool and find it helpful in improving your auditory skills.
            </p>
            <p>
                Would you like to try?
            </p>
            <div class="home-buttons">
                <button class="home-button" onclick="showTab('practice')">Go to Practice</button>
                <button class="home-button" onclick="showTab('test')">Go to Test</button>
            </div>
        </div>
    </div>

    <!-- Practice 页面 -->
    <div id="practice" class="tab-content hidden">
        <p>Please select a practice mode:</p>
        <select id="practiceMode" onchange="changePracticeMode(this.value)">
            <option value="manual" selected>Manual Mode</option>
            <option value="loop">Loop Mode</option>
        </select>

        <div id="manualMode">
            <p>Click on each button to listen to a Ling Six Sound.</p>
            <button class="sound-button" onclick="playSound('ah')">Play "ah" <i class="fas fa-volume-up"></i></button>
            <button class="sound-button" onclick="playSound('ee')">Play "ee" <i class="fas fa-volume-up"></i></button>
            <button class="sound-button" onclick="playSound('oo')">Play "oo" <i class="fas fa-volume-up"></i></button>
            <button class="sound-button" onclick="playSound('sh')">Play "sh" <i class="fas fa-volume-up"></i></button>
            <button class="sound-button" onclick="playSound('s')">Play "s" <i class="fas fa-volume-up"></i></button>
            <button class="sound-button" onclick="playSound('mm')">Play "mm" <i class="fas fa-volume-up"></i></button>
        </div>

        <div id="loopMode" class="hidden">
            <p>The system will randomly play the six sounds. Please listen carefully.</p>
            <button class="sound-button" onclick="startLoop()">Start Loop Mode <i class="fas fa-play"></i></button>
            <button class="sound-button" onclick="stopLoop()">Stop Loop Mode <i class="fas fa-stop"></i></button>
            <div id="currentSound"></div>
        </div>
    </div>

    <!-- Test 页面 -->
    <div id="test" class="tab-content hidden">
        <p>Select the type of test:</p>
        <select id="testType" onchange="selectTestType(this.value)">
            <option value="" disabled selected>Select test type</option>
            <option value="multipleChoice">Multiple Choice</option>
            <option value="sameOrDifferent">Same or Different</option>
        </select>

        <div id="multipleChoiceTest" class="hidden">
            <div class="test-options">
                <div>
                    <p>Select the number of options for the test:</p>
                    <select id="optionCount">
                        <option value="2" selected>2 Options</option>
                        <option value="3">3 Options</option>
                        <option value="4">4 Options</option>
                        <option value="5">5 Options</option>
                        <option value="6">6 Options</option>
                    </select>
                </div>
                <div>
                    <p>Select the number of questions:</p>
                    <select id="questionCount">
                        <option value="10">10 Questions</option>
                        <option value="30">30 Questions</option>
                        <option value="50">50 Questions</option>
                    </select>
                </div>
            </div>
            <div style="margin-top: 20px;">
                <button class="sound-button" id="startTest" onclick="startTest()">Start Test <i class="fas fa-play"></i></button>
                <button class="sound-button hidden" id="exitTest" onclick="exitTest()" style="position: fixed; bottom: 20px; right: 20px;">Exit Test <i class="fas fa-stop"></i></button>
            </div>
            <div id="progressBar" class="hidden">
                <div id="progress"></div>
            </div>
            <div id="testButtons" style="margin-top: 20px;"></div>
            <div id="resultMessage" style="margin-top: 20px; font-size: 1.5em; color: #ffffff;"></div>
            <button id="nextButton" class="sound-button hidden" onclick="nextQuestion()">Next</button>
            <div id="finalResult" class="hidden" style="margin-top: 20px; font-size: 1.5em; color: #ffffff;"></div>
        </div>

        <div id="sameOrDifferentTest" class="hidden">
            <p>Same or Different Listening Practice:</p>
            <button class="sound-button" onclick="startSameOrDifferent()">Start Practice <i class="fas fa-play"></i></button>
            <div id="pairingMessage" class="hidden">Please listen carefully, now playing...</div>
            <div id="sameOrDifferentButtons" style="margin-top: 20px;"></div>
            <div id="sameOrDifferentResult" style="margin-top: 20px; font-size: 1.5em; color: #ffffff;"></div>
        </div>
    </div>

    <div id="playingMessage" class="hidden">Please listen carefully, now playing...</div>

    <script>
        // 声音列表
        const sounds = ['ah', 'ee', 'oo', 'sh', 's', 'mm'];
        let correctSound = '';
        let currentQuestion = 0;
        let totalQuestions = 0;
        let correctAnswers = 0;
        let incorrectCounts = { 'ah': 0, 'ee': 0, 'oo': 0, 'sh': 0, 's': 0, 'mm': 0 };
        let isLooping = false;

        function playSound(sound, callback) {
            const playingMessage = document.getElementById('playingMessage');
            playingMessage.classList.remove('hidden');
            const audio = new Audio(`sounds/${sound}.wav`);
            audio.play();
            audio.onended = () => {
                playingMessage.classList.add('hidden');
                if (callback) callback();
            };
        }

        function showTab(tabId) {
            document.querySelectorAll('.nav-item').forEach(item => item.classList.remove('active'));
            document.querySelectorAll('.tab-content').forEach(content => content.classList.add('hidden'));
            document.getElementById(tabId).classList.remove('hidden');
            document.querySelector(`.nav-item[onclick="showTab('${tabId}')"]`).classList.add('active');

            // 如果是 Home 页面，显示描述
            if (tabId === 'home') {
                document.getElementById('description').style.display = 'block';
            } else {
                document.getElementById('description').style.display = 'none';
            }
        }

        function changePracticeMode(value) {
            const manualMode = document.getElementById('manualMode');
            const loopMode = document.getElementById('loopMode');
            if (value === 'manual') {
                manualMode.classList.remove('hidden');
                loopMode.classList.add('hidden');
            } else if (value === 'loop') {
                manualMode.classList.add('hidden');
                loopMode.classList.remove('hidden');
            }
        }

        function startLoop() {
            if (isLooping) return;
            isLooping = true;
            loopSounds();
        }

        function stopLoop() {
            isLooping = false;
        }

        function loopSounds() {
            if (!isLooping) return;
            const randomSound = sounds[Math.floor(Math.random() * sounds.length)];
            playSound(randomSound, () => {
                if (isLooping) setTimeout(loopSounds, 2000);
            });
        }

        function selectTestType(testType) {
            document.getElementById('multipleChoiceTest').classList.add('hidden');
            document.getElementById('sameOrDifferentTest').classList.add('hidden');
            if (testType === 'multipleChoice') {
                document.getElementById('multipleChoiceTest').classList.remove('hidden');
            } else if (testType === 'sameOrDifferent') {
                document.getElementById('sameOrDifferentTest').classList.remove('hidden');
            }
        }

        function startTest() {
            const optionCount = parseInt(document.getElementById('optionCount').value);
            totalQuestions = parseInt(document.getElementById('questionCount').value);
            currentQuestion = 0;
            correctAnswers = 0;
            incorrectCounts = { 'ah': 0, 'ee': 0, 'oo': 0, 'sh': 0, 's': 0, 'mm': 0 };
            document.getElementById('progressBar').classList.remove('hidden');
            document.getElementById('finalResult').classList.add('hidden');
            document.getElementById('startTest').classList.add('hidden');
            document.getElementById('exitTest').classList.remove('hidden');
            nextQuestion();
        }

        function exitTest() {
            location.reload();
        }

        function nextQuestion() {
            if (currentQuestion >= totalQuestions) {
                showFinalResult();
                return;
            }
            currentQuestion++;
            document.getElementById('resultMessage').textContent = '';
            document.getElementById('nextButton').classList.add('hidden');
            updateProgress();
            generateQuestion();
        }

        function generateQuestion() {
            const optionCount = parseInt(document.getElementById('optionCount').value);
            const testButtons = document.getElementById('testButtons');
            testButtons.innerHTML = '';
            const shuffledSounds = sounds.sort(() => 0.5 - Math.random()).slice(0, optionCount);
            correctSound = shuffledSounds[Math.floor(Math.random() * shuffledSounds.length)];

            shuffledSounds.forEach(sound => {
                const button = document.createElement('button');
                button.className = 'sound-button';
                button.textContent = sound;
                button.onclick = () => checkAnswer(sound);
                testButtons.appendChild(button);
            });

            playSound(correctSound);
        }

        function checkAnswer(selectedSound) {
            const resultMessage = document.getElementById('resultMessage');
            if (selectedSound === correctSound) {
                resultMessage.textContent = 'Correct!';
                resultMessage.style.color = '#28a745';
                correctAnswers++;
            } else {
                resultMessage.textContent = `Incorrect. The correct answer was "${correctSound}".`;
                resultMessage.style.color = '#dc3545';
                incorrectCounts[correctSound]++;
            }
            document.getElementById('nextButton').classList.remove('hidden');
        }

        function updateProgress() {
            const progress = document.getElementById('progress');
            progress.style.width = `${(currentQuestion / totalQuestions) * 100}%`;
        }

        function showFinalResult() {
            const finalResult = document.getElementById('finalResult');
            finalResult.classList.remove('hidden');
            const mostIncorrect = Object.keys(incorrectCounts).reduce((a, b) => incorrectCounts[a] > incorrectCounts[b] ? a : b);
            finalResult.innerHTML = `
                Test completed!<br>
                Correct answers: ${correctAnswers}/${totalQuestions}<br>
                Most incorrect sound: "${mostIncorrect}" with ${incorrectCounts[mostIncorrect]} errors.
            `;
        }

        function startSameOrDifferent() {
            const soundPair = [sounds[Math.floor(Math.random() * sounds.length)], sounds[Math.floor(Math.random() * sounds.length)]];
            const pairingMessage = document.getElementById('pairingMessage');
            pairingMessage.classList.remove('hidden');
            pairingMessage.textContent = 'Playing first sound...';
            playSound(soundPair[0], () => {
                pairingMessage.textContent = 'Playing second sound...';
                playSound(soundPair[1], () => {
                    pairingMessage.classList.add('hidden');
                    const buttonsContainer = document.getElementById('sameOrDifferentButtons');
                    buttonsContainer.innerHTML = '';
                    const sameButton = document.createElement('button');
                    sameButton.className = 'sound-button';
                    sameButton.textContent = 'Same';
                    sameButton.onclick = () => checkSameOrDifferent(soundPair, true);
                    const differentButton = document.createElement('button');
                    differentButton.className = 'sound-button';
                    differentButton.textContent = 'Different';
                    differentButton.onclick = () => checkSameOrDifferent(soundPair, false);
                    buttonsContainer.appendChild(sameButton);
                    buttonsContainer.appendChild(differentButton);
                });
            });
        }

        function checkSameOrDifferent(soundPair, isSame) {
            const resultMessage = document.getElementById('sameOrDifferentResult');
            if ((soundPair[0] === soundPair[1] && isSame) || (soundPair[0] !== soundPair[1] && !isSame)) {
                resultMessage.textContent = 'Correct!';
                resultMessage.style.color = '#28a745';
            } else {
                resultMessage.textContent = 'Incorrect!';
                resultMessage.style.color = '#dc3545';
            }
        }

        // 页面加载时显示首页
        document.addEventListener('DOMContentLoaded', () => {
            showTab('home');
        });
    </script>
</body>
</html>
